@startuml

@startuml
skinparam backgroundColor #EEEBDC
skinparam handwritten true

skinparam sequence {
	ArrowColor DeepSkyBlue
	ActorBorderColor DeepSkyBlue
	LifeLineBorderColor blue
	LifeLineBackgroundColor #A9DCDF

	ParticipantBorderColor DeepSkyBlue
	ParticipantBackgroundColor DodgerBlue
	ParticipantFontName Impact
	ParticipantFontSize 17
	ParticipantFontColor #A9DCDF

	ActorBackgroundColor aqua
	ActorFontColor DeepSkyBlue
	ActorFontSize 17
	ActorFontName Aapex
}

participant "VSA Proxy"
participant vCenter
participant Hypervisor
participant VM
participant MediaAgent

note over Hypervisor
    IntelliSnap is Commvault technology.
    It creates snapsot in primart storage.
    These snapshots can be mounted directly to
    the MediaAgent and backed up while the
    production server continues to service clients.
    Additionally, restores can be done almost
    instantaneously by reverting the snapshot as
    long as the array is fully functional.

    The entire game is of snapshot and how long
    it is retained.
end note


"VSA Proxy" -> vCenter: Locate VM on ESXi host
"VSA Proxy" -> Hypervisor: Initiate snapshot
Hypervisor -> VM: Quiesce VM
Hypervisor -> Hypervisor: Conducts a software snapshot on primary storage
Hypervisor --> "VSA Proxy":
"VSA Proxy" -> "Primary storage": Create snapshot copy
"VSA Proxy" -> "VSA Proxy": Mount snapshot copy to media server
note over "VSA Proxy"
    Did you notice creation of snapshot copy
    and it getting mounted - a core difference
    from traditional backup. Did you also notice
    that no data is being trasferred over wire
    (LAN) to send required data to MediaAgent.
end note
"VSA Proxy" -> MediaAgent: Request to do backup
MediaAgent -> BackupStorage: Stores backup data (in backup storage)
MediaAgent --> "VSA Proxy"
"VSA Proxy" -> "VSA Proxy": Unmount snapshot from media server


@enduml